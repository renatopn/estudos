<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo de Português - Estudo</title>
    <style>
        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background-color: #f0f8ff;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 800px;
            margin-bottom: 20px;
        }
        
        .score {
            font-size: 26px;
            font-weight: bold;
            color: #e74c3c;
            background-color: #fdeaea;
            padding: 8px 15px;
            border-radius: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border: 2px solid #e74c3c;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .settings-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .settings-btn:hover {
            background-color: #2980b9;
        }
        
        .game-container {
            background-color: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 800px;
            text-align: center;
        }
        
        .question-display {
            font-size: 36px;
            margin: 20px 0;
            padding: 20px;
            border-radius: 10px;
            color: white;
            background-color: #9b59b6;
        }
        
        .emoji-display {
            font-size: 60px;
            margin: 20px 0;
        }
        
        .question-text {
            font-size: 24px;
            margin: 20px 0;
            color: #34495e;
        }
        
        .answer-input {
            width: 80%;
            padding: 15px;
            font-size: 20px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .options-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .option-btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s;
            min-width: 120px;
        }
        
        .option-btn:hover {
            background-color: #2980b9;
            transform: scale(1.05);
        }
        
        .syllable-type-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .syllable-type-btn {
            background-color: #add1f3;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .syllable-type-btn.selected {
            background-color: #f37a0a;
            font-weight: bold;
        }
        
        .check-btn {
            background-color: #2ecc71;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
        }
        
        .check-btn:hover {
            background-color: #27ae60;
            transform: scale(1.05);
        }
        
        .next-btn {
            background-color: #f39c12;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            transition: all 0.3s;
            display: none;
        }
        
        .next-btn:hover {
            background-color: #d35400;
            transform: scale(1.05);
        }
        
        .message {
            font-size: 22px;
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }
        
        .success {
            background-color: #d5f5e3;
            color: #27ae60;
        }
        
        .error {
            background-color: #fadbd8;
            color: #e74c3c;
        }
        
        .correct-answer {
            font-weight: bold;
            margin-top: 10px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #2c3e50;
        }
        
        .json-textarea {
            width: 100%;
            height: 300px;
            font-family: monospace;
            padding: 10px;
            border: 1px solid #bdc3c7;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .modal-btn {
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            border: none;
        }
        
        .save-btn {
            background-color: #2ecc71;
            color: white;
        }
        
        .cancel-btn {
            background-color: #e74c3c;
            color: white;
        }
        
        .game-over {
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .final-score {
            font-size: 28px;
            margin-bottom: 20px;
        }
        
        .final-message {
            font-size: 24px;
            color: #7f8c8d;
        }
        
        .topic-selector {
            visibility: hidden;
            margin-bottom: 20px;
        }
        
        .topic-btn {
            background-color: #9b59b6;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        
        .topic-btn.active {
            background-color: #8e44ad;
            font-weight: bold;
        }
        
        @media (max-width: 600px) {
            .question-display {
                font-size: 28px;
            }
            
            .question-text {
                font-size: 20px;
            }
            
            .emoji-display {
                font-size: 48px;
            }
            
            .answer-input {
                width: 90%;
                font-size: 18px;
            }
            
            .option-btn {
                padding: 10px 15px;
                font-size: 16px;
                min-width: 100px;
            }
            
            .syllable-type-btn {
                padding: 8px 12px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <button class="settings-btn">⚙️</button>
        <div class="score">0/0</div>
    </div>
    
    <div class="game-container">
        <div id="question-display" class="question-display">Carregando...</div>
        <div id="emoji-display" class="emoji-display" style="display: none;"></div>
        
        
        <div id="options-container" class="options-container" style="display: none;"></div>
        
        <div id="syllable-type-container" class="syllable-type-container" style="display: none;">
            <button class="syllable-type-btn" data-type="monossílaba">Monossílaba</button>
            <button class="syllable-type-btn" data-type="dissílaba">Dissílaba</button>
            <button class="syllable-type-btn" data-type="trissílaba">Trissílaba</button>
            <button class="syllable-type-btn" data-type="polissílaba">Polissílaba</button>
        </div>
        
        <input type="text" id="answer-input" class="answer-input" placeholder="Digite sua resposta..." style="display: none;">
        
        <button id="check-btn" class="check-btn" style="display: none;">Verificar</button>
        <button id="next-btn" class="next-btn">Próxima</button>
        
        <div id="message" class="message"></div>

        <div class="topic-selector">
        <button class="topic-btn active" data-topic="r">Letra R</button>
        <button class="topic-btn" data-topic="diminutivo">Diminutivo</button>
        <button class="topic-btn" data-topic="nasal">Sons Nasais</button>
        <button class="topic-btn" data-topic="silabas">Separação Silábica</button>
    </div>
    </div>
    
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title">Configurações do Jogo</div>
            <textarea id="json-textarea" class="json-textarea"></textarea>
            <div class="modal-buttons">
                <button id="cancel-btn" class="modal-btn cancel-btn">Cancelar</button>
                <button id="save-btn" class="modal-btn save-btn">Salvar</button>
            </div>
        </div>
    </div>
    
    <script>
        // Dados iniciais do jogo por tópico
        let gameData = {
            r: [
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🚗",
                    answer: "carro",
                    explanation: "O emoji 🚗 é 'carro', que tem RR na palavra."
                },
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🐶",
                    answer: "cachorro",
                    explanation: "O emoji 🐶 é 'cachorro', que tem RR."
                },              
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🚪",
                    answer: "porta",
                    explanation: "O emoji 🚪 é 'porta', que tem apenas 1 R."
                },
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🌹",
                    answer: "rosa",
                    explanation: "O emoji 🌹 é 'rosa', que tem apenas 1 R."
                },
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🚂",
                    answer: "trem",
                    explanation: "O emoji 🚂 é um 'trem'."
                },
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🍒",
                    answer: "cereja",
                    explanation: "O emoji 🍒 é 'cereja', que tem apenas 1 R."
                },
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🐯",
                    answer: "tigre",
                    explanation: "O emoji 🐯 é 'tigre', que tem apenas 1 R."
                },
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🐭",
                    answer: "rato",
                    explanation: "O emoji 🐭 é um 'rato', que tem apenas 1 R."
                },
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🦍",
                    answer: "gorila",
                    explanation: "O emoji 🦍 é um 'gorila', que tem apenas 1 R."
                },
                {
                    type: "text",
                    question: "Qual é o nome deste emoji?",
                    emoji: "🐊",
                    answer: "jacaré",
                    explanation: "O emoji 🐊 é 'jacaré', que tem apenas 1 R."
                }
            ],
            diminutivo: [
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "casa",
                    answer: "casinha",
                    explanation: "O diminutivo de 'casa' é 'casinha'."
                },
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "cão",
                    answer: "cãozinho",
                    explanation: "O diminutivo de 'cão' é 'cãozinho'."
                },
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "flor",
                    answer: "florzinha",
                    explanation: "O diminutivo de 'flor' é 'florzinha'."
                },
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "livro",
                    answer: "livrinho",
                    explanation: "O diminutivo de 'livro' é 'livrinho'."
                },
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "pé",
                    answer: "pezinho",
                    explanation: "O diminutivo de 'pé' é 'pezinho'."
                },
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "mão",
                    answer: "mãozinha",
                    explanation: "O diminutivo de 'mão' é 'mãozinha'."
                },
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "sol",
                    answer: "solzinho",
                    explanation: "O diminutivo de 'sol' é 'sozinho'."
                },
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "pai",
                    answer: "paizinho",
                    explanation: "O diminutivo de 'pai' é 'paizinho'."
                },
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "irmão",
                    answer: "irmãozinho",
                    explanation: "O diminutivo de 'irmão' é 'irmãozinho'."
                },
                {
                    type: "text",
                    question: "Qual é o diminutivo de:",
                    word: "avó",
                    answer: "avozinha",
                    explanation: "O diminutivo de 'avó' é 'avozinha'."
                }
            ],
            nasal: [
                {
                    type: "multiple",
                    question: "Qual palavra tem som nasal?",
                    options: ["cama", "banana", "pente", "barco"],
                    answer: "pente",
                    explanation: "'Pente' tem som nasal por causa do 'n' seguido de consoante."
                },
                {
                    type: "multiple",
                    question: "Qual palavra tem som nasal?",
                    options: ["bala", "mala", "tampa", "pato"],
                    answer: "tampa",
                    explanation: "'Tampa' tem som nasal por causa do 'm' seguido de consoante."
                },
                {
                    type: "multiple",
                    question: "Qual palavra tem som nasal?",
                    options: ["casa", "vaso", "pomba", "sapo"],
                    answer: "pomba",
                    explanation: "'Pomba' tem som nasal por causa do 'm' seguido de consoante."
                },
                {
                    type: "multiple",
                    question: "Qual palavra tem som nasal?",
                    options: ["faca", "boca", "penca", "pipa"],
                    answer: "penca",
                    explanation: "'Penca' tem som nasal por causa do 'n' seguido de consoante."
                },
                {
                    type: "multiple",
                    question: "Qual palavra tem som nasal?",
                    options: ["lupa", "rupa", "tumba", "cuba"],
                    answer: "tumba",
                    explanation: "'Tumba' tem som nasal por causa do 'm' seguido de consoante."
                }
            ],
            silabas: [
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "casa",
                    syllables: "ca-sa",
                    syllableType: "dissílaba",
                    explanation: "'Casa' separa-se em 'ca-sa' e é uma palavra dissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "árvore",
                    syllables: "ár-vo-re",
                    syllableType: "trissílaba",
                    explanation: "'Árvore' separa-se em 'ár-vo-re' e é uma palavra trissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "sol",
                    syllables: "sol",
                    syllableType: "monossílaba",
                    explanation: "'Sol' é uma palavra monossílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "computador",
                    syllables: "com-pu-ta-dor",
                    syllableType: "polissílaba",
                    explanation: "'Computador' separa-se em 'com-pu-ta-dor' e é uma palavra polissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "carro",
                    syllables: "car-ro",
                    syllableType: "dissílaba",
                    explanation: "'Carro' separa-se em 'car-ro' (com RR) e é uma palavra dissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "passo",
                    syllables: "pas-so",
                    syllableType: "dissílaba",
                    explanation: "'Passo' separa-se em 'pas-so' (com SS) e é uma palavra dissílaba."
                },{
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "carroça",
                    syllables: "car-ro-ça",
                    syllableType: "trissílaba",
                    explanation: "'Tempo' separa-se em 'car-ro-ça' e é uma palavra trissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "tempo",
                    syllables: "tem-po",
                    syllableType: "dissílaba",
                    explanation: "'Tempo' separa-se em 'tem-po' (com M antes de P) e é uma palavra dissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "cantar",
                    syllables: "can-tar",
                    syllableType: "dissílaba",
                    explanation: "'Cantar' separa-se em 'can-tar' (com N antes de T) e é uma palavra dissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "asfalto",
                    syllables: "as-fal-to",
                    syllableType: "trissílaba",
                    explanation: "'Asfalto' separa-se em 'as-fal-to' (com S antes de F) e é uma palavra trissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "construir",
                    syllables: "cons-tru-ir",
                    syllableType: "trissílaba",
                    explanation: "'Construir' separa-se em 'cons-tru-ir' (com N antes de S e S antes de T) e é uma palavra trissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "prato",
                    syllables: "pra-to",
                    syllableType: "dissílaba",
                    explanation: "'Prato' separa-se em 'pra-to' e é uma palavra dissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "flor",
                    syllables: "flor",
                    syllableType: "monossílaba",
                    explanation: "'Flor' é uma palavra monossílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "elefante",
                    syllables: "e-le-fan-te",
                    syllableType: "polissílaba",
                    explanation: "'Elefante' separa-se em 'e-le-fan-te' e é uma palavra polissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "pássaro",
                    syllables: "pás-sa-ro",
                    syllableType: "trissílaba",
                    explanation: "'Pássaro' separa-se em 'pás-sa-ro' (com SS) e é uma palavra trissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "homem",
                    syllables: "ho-mem",
                    syllableType: "dissílaba",
                    explanation: "'Homem' separa-se em 'ho-mem' e é uma palavra dissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "mãe",
                    syllables: "mãe",
                    syllableType: "monossílaba",
                    explanation: "'Mãe' é uma palavra monossílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "universidade",
                    syllables: "u-ni-ver-si-da-de",
                    syllableType: "polissílaba",
                    explanation: "'Universidade' separa-se em 'u-ni-ver-si-da-de' e é uma palavra polissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "triste",
                    syllables: "tris-te",
                    syllableType: "dissílaba",
                    explanation: "'Triste' separa-se em 'tris-te' (com S antes de T) e é uma palavra dissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "criança",
                    syllables: "cri-an-ça",
                    syllableType: "trissílaba",
                    explanation: "'Criança' separa-se em 'cri-an-ça' e é uma palavra trissílaba."
                },
                {
                    type: "syllables",
                    question: "Classifique e separe as sílabas de:",
                    word: "pão",
                    syllables: "pão",
                    syllableType: "monossílaba",
                    explanation: "'Pão' é uma palavra monossílaba."
                }
            ]
        };

        // Variáveis do jogo
        let currentTopic = "r";
        let currentQuestion = null;
        let usedQuestions = { r: [], diminutivo: [], nasal: [], silabas: [] };
        let score = 0;
        let totalQuestions = 0;
        let gameActive = false;
        let selectedSyllableType = null;
        
        // Elementos do DOM
        const questionDisplay = document.getElementById('question-display');
        const emojiDisplay = document.getElementById('emoji-display');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const syllableTypeContainer = document.getElementById('syllable-type-container');
        const syllableTypeBtns = document.querySelectorAll('.syllable-type-btn');
        const answerInput = document.getElementById('answer-input');
        const checkBtn = document.getElementById('check-btn');
        const nextBtn = document.getElementById('next-btn');
        const messageDisplay = document.getElementById('message');
        const scoreDisplay = document.querySelector('.score');
        const settingsBtn = document.querySelector('.settings-btn');
        const settingsModal = document.getElementById('settings-modal');
        const jsonTextarea = document.getElementById('json-textarea');
        const saveBtn = document.getElementById('save-btn');
        const cancelBtn = document.getElementById('cancel-btn');
        const topicBtns = document.querySelectorAll('.topic-btn');
        
        // Frases de feedback
        const successPhrases = [
            "Parabéns! Você acertou!",
            "Muito bem! Você está aprendendo muito!",
            "Correto! Você é um expert em português!",
            "Ótimo trabalho! Continue assim!",
            "Isso aí! Você é muito inteligente!"
        ];
        
        const errorPhrases = [
            "Ops! Não foi dessa vez, mas continue tentando!",
            "Quase lá! Pratique mais um pouco!",
            "Não desanime! Você vai conseguir na próxima!",
            "Errou, mas isso faz parte do aprendizado!",
            "Tente novamente! Você consegue!"
        ];
        
        const finalMessages = [
            {min: 0, max: 30, message: "Você pode melhorar! Pratique mais!"},
            {min: 31, max: 70, message: "Bom trabalho! Continue praticando!"},
            {min: 71, max: 90, message: "Excelente! Você está quase dominando tudo!"},
            {min: 91, max: 100, message: "Incrível! Você é um mestre do português!"}
        ];
        
        // Inicializar o jogo
        function initGame() {
            usedQuestions = { r: [], diminutivo: [], nasal: [], silabas: [] };
            score = 0;
            totalQuestions = 0;
            gameActive = true;
            updateScore();
            nextQuestion();
        }
        
        // Mudar tópico
        function changeTopic(topic) {
            currentTopic = topic;
            
            // Atualizar botões ativos
            topicBtns.forEach(btn => {
                if (btn.dataset.topic === topic) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Reiniciar o jogo com o novo tópico
           // initGame();
        }
        
        // Selecionar próxima pergunta
        function nextQuestion() {

            // Selecionar pergunta aleatória
            const randomTopic = Math.floor(Math.random() * Object.keys(gameData).length);   
            currentTopic = Object.keys(gameData)[randomTopic];
            changeTopic(currentTopic);

            // Verificar se ainda há perguntas disponíveis
            const availableQuestions = gameData[currentTopic].filter(
                q => !usedQuestions[currentTopic].includes(gameData[currentTopic].indexOf(q))
            );
            
           /* if (availableQuestions.length === 0) {
                endGame();
                return;
            }*/

            // Selecionar pergunta aleatória
            const randomIndex = Math.floor(Math.random() * availableQuestions.length);
            currentQuestion = availableQuestions[randomIndex];
            
            // Adicionar à lista de perguntas usadas
            usedQuestions[currentTopic].push(gameData[currentTopic].indexOf(currentQuestion));
            
            // Atualizar exibição
            questionDisplay.textContent = currentTopic === "r" ? currentQuestion.question : 
                                        currentTopic === "diminutivo" ? `${currentQuestion.question} ${currentQuestion.word}?` :
                                        currentTopic === "silabas" ? `${currentQuestion.question} '${currentQuestion.word}'` :
                                        currentQuestion.question;
            
            // Mostrar emoji se for o caso
            if (currentQuestion.emoji) {
                emojiDisplay.textContent = currentQuestion.emoji;
                emojiDisplay.style.display = 'block';
            } else {
                emojiDisplay.style.display = 'none';
            }
            
            // Configurar elementos de resposta
            optionsContainer.style.display = 'none';
            answerInput.style.display = 'none';
            syllableTypeContainer.style.display = 'none';
            checkBtn.style.display = 'none';
            
            // Resetar seleção de tipo silábico
            selectedSyllableType = null;
            syllableTypeBtns.forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Configurar tipo de pergunta
            if (currentQuestion.type === "multiple") {
                optionsContainer.style.display = 'flex';
                
                // Limpar opções anteriores
                optionsContainer.innerHTML = '';
                
                // Adicionar novas opções
                currentQuestion.options.forEach(option => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.textContent = option;
                    btn.addEventListener('click', () => selectOption(option));
                    optionsContainer.appendChild(btn);
                });
            } 
            else if (currentQuestion.type === "syllables") {
                answerInput.style.display = 'block';
                syllableTypeContainer.style.display = 'flex';
                checkBtn.style.display = 'block';
                answerInput.placeholder = "Ex: ca-sa (use - ou espaço)";
            }
            else {
                answerInput.style.display = 'block';
                checkBtn.style.display = 'block';
                answerInput.placeholder = "Digite sua resposta...";
            }
            
            // Configurar botões
            nextBtn.style.display = 'none';
            
            // Limpar mensagens e campo de resposta
            answerInput.value = '';
            messageDisplay.style.display = 'none';
            messageDisplay.className = 'message';
            
            if (currentQuestion.type === "text" || currentQuestion.type === "syllables") {
                answerInput.focus();
            }
        }
        
        // Selecionar opção (para questões de múltipla escolha)
        function selectOption(option) {
            totalQuestions++;
            
            // Verificar resposta
            if (option === currentQuestion.answer) {
                // Resposta correta
                score++;
                showFeedback(true);
            } else {
                // Resposta incorreta
                showFeedback(false, currentQuestion.answer);
            }
            
            updateScore();
            
            // Desativar botões de opção
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.disabled = true;
                if (btn.textContent === currentQuestion.answer) {
                    btn.style.backgroundColor = '#2ecc71';
                } else if (btn.textContent === option && option !== currentQuestion.answer) {
                    btn.style.backgroundColor = '#e74c3c';
                }
            });
            
            // Mostrar botão de próxima pergunta
            nextBtn.style.display = 'block';
        }
        
        // Selecionar tipo silábico
        function selectSyllableType(type) {
            selectedSyllableType = type;
            syllableTypeBtns.forEach(btn => {
                if (btn.dataset.type === type) {
                    btn.classList.add('selected');
                } else {
                    btn.classList.remove('selected');
                }
            });
        }
        
        // Verificar resposta (para questões de texto e sílabas)
        function checkAnswer() {
            if (!currentQuestion || !gameActive) return;
            
            let isCorrect = false;
            let userAnswer = "";
            
            if (currentQuestion.type === "syllables") {
                userAnswer = answerInput.value.trim().toLowerCase();
                // Normalizar a resposta (aceitar tanto - quanto espaço como separador)
                const normalizedUserAnswer = userAnswer.replace(/ /g, '-');
                const normalizedCorrectAnswer = currentQuestion.syllables.toLowerCase();
                
                // Verificar separação silábica e tipo
                isCorrect = normalizedUserAnswer === normalizedCorrectAnswer && 
                           selectedSyllableType === currentQuestion.syllableType;
            } else {
                userAnswer = answerInput.value.trim().toLowerCase();
                const correctAnswer = currentQuestion.answer.toLowerCase();
                isCorrect = userAnswer === correctAnswer;
            }
            
            totalQuestions++;
            
            if (isCorrect) {
                // Resposta correta
                score++;
                showFeedback(true);
            } else {
                // Resposta incorreta
                let correctAnswer = currentQuestion.answer;
                if (currentQuestion.type === "syllables") {
                    correctAnswer = `${currentQuestion.syllables} (${currentQuestion.syllableType})`;
                }
                showFeedback(false, correctAnswer);
            }
            
            updateScore();
            
            // Mostrar botão de próxima pergunta
            nextBtn.style.display = 'block';
            checkBtn.style.display = 'none';
        }
        
        // Mostrar feedback
        function showFeedback(isCorrect, correctAnswer = null) {
            messageDisplay.style.display = 'block';
            
            if (isCorrect) {
                // Feedback positivo
                const randomPhrase = successPhrases[Math.floor(Math.random() * successPhrases.length)];
                messageDisplay.textContent = `${randomPhrase}`;
                messageDisplay.className = 'message success';
                setTimeout(() => {
                     nextBtn.click();
                }, 1500); // Esperar 2 segundos antes de limpar a mensagem
            } else {
                // Feedback negativo
                const randomPhrase = errorPhrases[Math.floor(Math.random() * errorPhrases.length)];
                messageDisplay.innerHTML = `${randomPhrase}<div class="correct-answer">Resposta correta: ${correctAnswer}</div>${currentQuestion.explanation ? `<div>${currentQuestion.explanation}</div>` : ''}`;
                messageDisplay.className = 'message error';
            }
        }
        
        // Atualizar pontuação
        function updateScore() {
            scoreDisplay.textContent = `${score}/${totalQuestions}`;
        }
        
        // Finalizar jogo
        function endGame() {
            gameActive = false;
            answerInput.disabled = true;
            checkBtn.style.display = 'none';
            nextBtn.style.display = 'none';
            optionsContainer.style.display = 'none';
            answerInput.style.display = 'none';
            syllableTypeContainer.style.display = 'none';
            
            // Calcular porcentagem de acertos
            const percentage = totalQuestions > 0 ? Math.round((score / totalQuestions) * 100) : 0;
            
            // Selecionar mensagem final
            let finalMessage = "";
            for (const msg of finalMessages) {
                if (percentage >= msg.min && percentage <= msg.max) {
                    finalMessage = msg.message;
                    break;
                }
            }
            
            // Exibir tela de fim de jogo
            questionDisplay.textContent = "Fim do Jogo!";
            emojiDisplay.style.display = 'none';
            questionText.innerHTML = `
                <div class="game-over">Jogo Concluído!</div>
                <div class="final-score">Sua pontuação: ${score}/${totalQuestions} (${percentage}%)</div>
                <div class="final-message">${finalMessage}</div>
            `;
            
            // Limpar mensagens
            messageDisplay.style.display = 'none';
        }
        
        // Configurações - Abrir modal
        function openSettings() {
            jsonTextarea.value = JSON.stringify(gameData, null, 2);
            settingsModal.style.display = 'flex';
        }
        
        // Configurações - Fechar modal
        function closeSettings() {
            settingsModal.style.display = 'none';
        }
        
        // Configurações - Salvar
        function saveSettings() {
            try {
                const newData = JSON.parse(jsonTextarea.value);
                
                // Validar dados
                if (typeof newData !== 'object' || newData === null) {
                    throw new Error("Os dados devem ser um objeto");
                }
                
                if (!newData.r || !newData.diminutivo || !newData.nasal || !newData.silabas) {
                    throw new Error("Os dados devem conter os tópicos 'r', 'diminutivo', 'nasal' e 'silabas'");
                }
                
                for (const topic in newData) {
                    if (!Array.isArray(newData[topic])) {
                        throw new Error(`O tópico ${topic} deve ser um array`);
                    }
                    
                    for (const item of newData[topic]) {
                        if (!item.type || !item.question) {
                            throw new Error("Cada item deve ter 'type' e 'question'");
                        }
                    }
                }
                
                // Salvar novos dados e reiniciar jogo
                gameData = newData;
                closeSettings();
                initGame();
            } catch (error) {
                alert(`Erro ao salvar configurações: ${error.message}`);
            }
        }
        
        // Event Listeners
        checkBtn.addEventListener('click', checkAnswer);
        answerInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                checkAnswer();
            }
        });
        
        nextBtn.addEventListener('click', nextQuestion);
        
        settingsBtn.addEventListener('click', openSettings);
        saveBtn.addEventListener('click', saveSettings);
        cancelBtn.addEventListener('click', closeSettings);
        
        topicBtns.forEach(btn => {
            btn.addEventListener('click', () => changeTopic(btn.dataset.topic));
        });
        
        syllableTypeBtns.forEach(btn => {
            btn.addEventListener('click', () => selectSyllableType(btn.dataset.type));
        });
        
        // Iniciar o jogo quando a página carregar
        window.addEventListener('load', initGame);
    </script>
</body>
</html>